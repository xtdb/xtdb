[:project
 {:projections [{y x.1/y}]}
 [:map
  {:projections [{_sq_2 true}]}
  [:semi-join
   {:conditions [(> _needle z)]}
   [:map
    {:projections [{_needle (== x.1/z 1)}]}
    [:rename
     {:prefix x.1}
     [:scan {:table #xt/table x, :columns [y z]}]]]
   [:project
    {:projections [{z y.3/z}]}
    [:rename
     {:prefix y.3}
     [:scan {:table #xt/table y, :columns [z]}]]]]]]
