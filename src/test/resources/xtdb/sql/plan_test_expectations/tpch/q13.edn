[:order-by
 {:order-specs [[custdist {:direction :desc, :null-ordering :nulls-first}]
  [c_count {:direction :desc, :null-ordering :nulls-first}]]}
 [:project
  [c_count {custdist _row_count_4}]
  [:group-by
   [c_count {_row_count_4 (row-count)}]
   [:project
    [{c_custkey c.1/_id} {c_count _count_out_3}]
    [:group-by
     [c.1/_id {_count_out_3 (count o.2/_id)}]
     [:left-outer-join
      {:conditions [{c.1/_id o.2/o_custkey}
       (not (like o.2/o_comment "%special%requests%"))]}
      [:rename c.1 [:scan {:table #xt/table customer, :columns [_id]}]]
      [:rename
       o.2
       [:scan
        {:table #xt/table orders, :columns [_id o_comment o_custkey]}]]]]]]]]
