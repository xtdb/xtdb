[:project
 {:projections [{n_name n.5/n_name} revenue]}
 [:order-by
  {:order-specs [[revenue {:direction :desc, :null-ordering :nulls-first}]]}
  [:project
   {:projections [n.5/n_name {revenue _sum_out_7}]}
   [:group-by
    [n.5/n_name {_sum_out_7 (sum _sum_in_8)}]
    [:map
     {:projections [{_sum_in_8 (* l.3/l_extendedprice (- 1 l.3/l_discount))}]}
     [:mega-join
      {:conditions [{n.5/n_regionkey r.6/_id}
       {s.4/s_nationkey n.5/_id}
       {l.3/l_suppkey s.4/_id}
       {c.1/c_nationkey s.4/s_nationkey}
       {o.2/_id l.3/l_orderkey}
       {c.1/_id o.2/o_custkey}]}
      [[:rename
        r.6
        [:scan
         {:table #xt/table region, :columns [_id {r_name (== r_name "ASIA")}]}]]
       [:rename
        n.5
        [:scan {:table #xt/table nation, :columns [_id n_name n_regionkey]}]]
       [:rename
        s.4
        [:scan {:table #xt/table supplier, :columns [_id s_nationkey]}]]
       [:rename
        l.3
        [:scan
         {:table #xt/table lineitem, :columns [l_orderkey l_extendedprice l_suppkey l_discount]}]]
       [:rename
        c.1
        [:scan {:table #xt/table customer, :columns [c_nationkey _id]}]]
       [:rename
        o.2
        [:scan
         {:table #xt/table orders, :columns [_id
          {o_orderdate
           (and
            (<
             o_orderdate
             (+
              #xt/date "1994-01-01"
              (single-field-interval "1" "YEAR" 2 6)))
            (>= o_orderdate #xt/date "1994-01-01"))}
          o_custkey]}]]]]]]]]]
