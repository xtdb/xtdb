[:top
 {:skip nil, :limit 100}
 [:project
  {:projections [{s_acctbal s.2/s_acctbal}
   {s_name s.2/s_name}
   {n_name n.4/n_name}
   {p_partkey p_partkey}
   {p_mfgr p.1/p_mfgr}
   {s_address s.2/s_address}
   {s_phone s.2/s_phone}
   {s_comment s.2/s_comment}]}
  [:order-by
   {:order-specs [[s.2/s_acctbal {:direction :desc, :null-ordering :nulls-first}]
    [n.4/n_name {:direction :asc, :null-ordering :nulls-last}]
    [s.2/s_name {:direction :asc, :null-ordering :nulls-last}]
    [_ob13 {:direction :asc, :null-ordering :nulls-last}]]}
   [:project
    {:projections [s.2/s_acctbal
     s.2/s_name
     n.4/n_name
     {p_partkey p.1/_id}
     p.1/p_mfgr
     s.2/s_address
     s.2/s_phone
     s.2/s_comment
     {_ob13 p.1/_id}]}
    [:map
     {:projections [{_sq_6 _min_out_12}]}
     [:select
      {:predicate (== ps.3/ps_supplycost _min_out_12)}
      [:group-by
       {:columns [p.1/_id
        p.1/p_size
        p.1/p_mfgr
        p.1/p_type
        s.2/s_comment
        s.2/s_name
        s.2/s_address
        s.2/s_phone
        s.2/_id
        s.2/s_acctbal
        s.2/s_nationkey
        ps.3/ps_partkey
        ps.3/ps_supplycost
        ps.3/ps_suppkey
        n.4/_id
        n.4/n_name
        n.4/n_regionkey
        r.5/_id
        r.5/r_name
        _row_number_0
        {_min_out_12 (min ps.7/ps_supplycost)}]}
       [:left-outer-join
        {:conditions [{p.1/_id ps.7/ps_partkey}]}
        [:map
         {:projections [{_row_number_0 (row-number)}]}
         [:mega-join
          {:conditions [{n.4/n_regionkey r.5/_id}
           {s.2/s_nationkey n.4/_id}
           {p.1/_id ps.3/ps_partkey}
           {s.2/_id ps.3/ps_suppkey}]}
          [[:rename
            r.5
            [:scan
             {:table #xt/table region, :columns [_id {r_name (== r_name "EUROPE")}]}]]
           [:rename
            n.4
            [:scan {:table #xt/table nation, :columns [_id n_name n_regionkey]}]]
           [:rename
            ps.3
            [:scan
             {:table #xt/table partsupp, :columns [ps_partkey ps_supplycost ps_suppkey]}]]
           [:rename
            p.1
            [:scan
             {:table #xt/table part, :columns [_id
              {p_size (== p_size 15)}
              p_mfgr
              {p_type (like p_type "%BRASS")}]}]]
           [:rename
            s.2
            [:scan
             {:table #xt/table supplier, :columns [s_comment
              s_name
              s_address
              s_phone
              _id
              s_acctbal
              s_nationkey]}]]]]]
        [:mega-join
         {:conditions [{n.9/n_regionkey r.10/_id}
          {s.8/s_nationkey n.9/_id}
          {ps.7/ps_suppkey s.8/_id}]}
         [[:rename
           r.10
           [:scan
            {:table #xt/table region, :columns [_id {r_name (== r_name "EUROPE")}]}]]
          [:rename
           n.9
           [:scan {:table #xt/table nation, :columns [_id n_regionkey]}]]
          [:rename
           ps.7
           [:scan
            {:table #xt/table partsupp, :columns [ps_partkey ps_supplycost ps_suppkey]}]]
          [:rename
           s.8
           [:scan
            {:table #xt/table supplier, :columns [_id s_nationkey]}]]]]]]]]]]]]
